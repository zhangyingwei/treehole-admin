webpackJsonp([5],{181:function(t,e,i){function n(t){o||i(698)}var o=!1,s=i(26)(i(374),i(650),n,null,null);s.options.__file="/Users/zhangyw/zhangyw/code/github.com/treehole-admin/src/components/treehole/article/new.vue",s.esModule&&Object.keys(s.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] new.vue: functional components are not supported with templates, they should use render functions."),t.exports=s.exports},374:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=i(76),o=function(t){return t&&t.__esModule?t:{default:t}}(n);e.default={data:function(){return{value:"",kinds:[],intervalId:"",info:{title:"",tags:"",kind:null,url:"",allowCommont:!0,id:null},toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,link:!0,imagelink:!0,code:!0,table:!0,fullscreen:!0,htmlcode:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,subfield:!0,preview:!0},formRules:{required:["title","kind"]}}},methods:{onSave:function(e){var i=this;this.validInfo()&&t.Article.save({id:this.info.id,title:this.info.title,subpath:this.info.url,tags:""===this.info.tags?"":this.info.tags.join(","),categories:this.info.kind,content:this.value,usecommont:this.info.allowCommont?"on":"off"}).then(function(t){console.log(t),t.ok?400==t.code?i.$Message(t.message):(i.info.id=t.result.data,i.$Message("保存成功"),e&&i.$router.replace("/article/history")):i.$Message("服务端错误")})},validInfo:function(){return this.info.title?!!this.info.kind||(this.$Message("请选择文章分类"),!1):(this.$Message("请填写标题"),!1)},submite:function(){var e=this;this.validInfo()&&t.Article.publish({id:this.info.id,title:this.info.title,subpath:this.info.url,tags:""===this.info.tags?"":this.info.tags.join(","),categories:this.info.kind,content:this.value,usecommont:this.info.allowCommont?"on":"off"}).then(function(t){console.log(t),t.ok?400==t.code?e.$Message(t.message):(e.info.id=t.result.data,e.$Message("发布文章成功"),e.$router.replace("/article/history")):e.$Message("服务端错误")})},getKinds:function(){var e=this;t.Article.kinds().then(function(t){t.ok?e.kinds=t.result.data.map(function(t){return t.title=t.name,t.key=t.id,t}):e.$Message("加载分类信息错误")})},initArticle:function(){var t=o.default.state.article;t?(this.value=t.content,this.info.title=t.title,this.info.tags=t.tags,this.info.kind=t.categories,this.info.url=t.subpath,this.info.allowCommont="on"===t.usecommont,this.info.id=t.id,console.log(this.info),o.default.dispatch("updateArticle",null)):this.value="文章简介\n\n\x3c!-- more --\x3e\n\n文章内容"}},mounted:function(){this.getKinds(),this.initArticle();var t=this,e=setInterval(function(){t.$Message({type:"success",text:"保存成功"}),t.onSave(!1)},12e4);this.intervalId=e},beforeDestroy:function(){clearInterval(this.intervalId)}}}).call(e,i(27))},650:function(t,e,i){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"padding",rawName:"v-padding",value:20,expression:"20"}],staticClass:"app-home"},[i("div",{staticClass:"h-panel"},[i("div",{directives:[{name:"padding",rawName:"v-padding",value:20,expression:"20"}],staticClass:"h-panel-bar"},[t._v("\n            新建文章\n        ")]),t._v(" "),i("div",{directives:[{name:"padding",rawName:"v-padding",value:20,expression:"20"}],staticClass:"h-panel-bar red-color"},[t._v("\n            在写作的过程中不要忘记保存 ( ctrl+s/command+s ) 哦，虽然程序会每隔2分钟自动保存一次！！！\n        ")]),t._v(" "),i("div",{staticClass:"h-panel-body"},[i("div",{staticClass:"h-row"},[i("div",{directives:[{name:"padding",rawName:"v-padding",value:10,expression:"10"}],staticClass:"h-col-6"},[i("Form",{attrs:{labelPosition:"left",labelWidth:100,rules:t.formRules,model:t.info}},[i("FormItem",{attrs:{label:"标题",prop:"title"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.info.title,expression:"info.title"}],attrs:{type:"text",placeholder:"请输入文章标题"},domProps:{value:t.info.title},on:{input:function(e){e.target.composing||t.$set(t.info,"title",e.target.value)}}})]),t._v(" "),i("FormItem",{attrs:{label:"个性化访问",prop:"url"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.info.url,expression:"info.url"}],attrs:{type:"text",placeholder:"个性化访问，如 article1,默认为文章编号"},domProps:{value:t.info.url},on:{input:function(e){e.target.composing||t.$set(t.info,"url",e.target.value)}}})]),t._v(" "),i("FormItem",{attrs:{label:"标签",prop:"tags"}},[i("TagInput",{attrs:{placeholder:"tags",readonly:!1},model:{value:t.info.tags,callback:function(e){t.$set(t.info,"tags",e)},expression:"info.tags"}})],1),t._v(" "),i("FormItem",{attrs:{label:"分类",prop:"kind"}},[i("Select",{attrs:{datas:t.kinds,placeholder:"请选择文章分类"},model:{value:t.info.kind,callback:function(e){t.$set(t.info,"kind",e)},expression:"info.kind"}})],1),t._v(" "),i("FormItem",{attrs:{label:"允许评论",prop:"commont"}},[i("h-switch",{model:{value:t.info.allowCommont,callback:function(e){t.$set(t.info,"allowCommont",e)},expression:"info.allowCommont"}})],1),t._v(" "),i("FormItem",[i("div",{staticClass:"h-btn-group h-btn-group-l"},[i("button",{staticClass:"h-btn h-btn-primary",on:{click:t.submite}},[i("i",{staticClass:"h-icon-outbox"}),i("span",[t._v("发表")])]),t._v(" "),i("button",{staticClass:"h-btn h-btn-blue",on:{click:function(e){t.onSave(!0)}}},[i("i",{staticClass:"h-icon-completed"}),i("span",[t._v("存为草稿")])])])])],1)],1),t._v(" "),i("div",{staticClass:"h-col-18"},[i("mavon-editor",{directives:[{name:"height",rawName:"v-height",value:500,expression:"500"}],attrs:{toolbars:t.toolbars},on:{save:function(e){t.onSave(!1)}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)])])])])},staticRenderFns:[]},t.exports.render._withStripped=!0},698:function(t,e){}});